---
jupyter:
  jupytext:
    formats: ipynb,Rmd
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.15.2
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
---

```{python}
# %load_ext autoreload
# %autoreload 2

from cross_image_self_atten import (
    get_clip_encoders,
    plot_attention,
    umap_plot,
    plot_img_with_idx_annotation
)
```

```{python}
config_init = get_clip_encoders()
```

```{python}
good_img_path = "../datasets/MVTec/screw/train/good/003.png"
query_img_path = "../datasets/MVTec/screw/test/scratch_neck/002.png"
```

```{python}
plot_attention(query_img_path, 115, config_init, good_img_path)
```

```{python jupyter={'outputs_hidden': False}}
u = umap_plot(
    query_img_path, 
    config_init,
    n_neighbors=30,
    min_dist=0.0,
    n_components=2,
    idx_plot_module=2,
    backbone="dino"
)
```

```{python}
# !whereis python

```

```{python}

```
